<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>django起步 | 小象のblog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="起步 django项目目录  12345678mysite&#x2F;    manage.py #管理django项目的命令行工具    mysite&#x2F;	#python包，名字就是当引用它内部任何东西时需要用到的python包名        __init__.py	#告诉python这个目录应该被认为是一个python包        settings.py	#项目的配置文件        urls.p">
<meta property="og:type" content="article">
<meta property="og:title" content="django起步">
<meta property="og:url" content="https://xiaoxiangxiong.gitee.io/2021/03/16/django%E8%B5%B7%E6%AD%A5/index.html">
<meta property="og:site_name" content="小象のblog">
<meta property="og:description" content="起步 django项目目录  12345678mysite&#x2F;    manage.py #管理django项目的命令行工具    mysite&#x2F;	#python包，名字就是当引用它内部任何东西时需要用到的python包名        __init__.py	#告诉python这个目录应该被认为是一个python包        settings.py	#项目的配置文件        urls.p">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-03-16T07:38:07.000Z">
<meta property="article:modified_time" content="2021-04-09T03:18:20.135Z">
<meta property="article:author" content="小象">
<meta property="article:tag" content="xiaoxiang,小象のblog">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="小象のblog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="mheader">
    <div class="mtitle-wrap">
        <a href="/" class="mtitle">小象のblog</a>
		<a href="/archives/" class="msubtitle">概览</a>
		<a href="http://xiaoxiang.space" target="_self" class="msubtitle">说点什么</a>
    </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-django起步" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/03/16/django%E8%B5%B7%E6%AD%A5/" class="article-date">
  <time datetime="2021-03-16T07:38:07.000Z" itemprop="datePublished">2021-03-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>►<a class="article-category-link" href="/categories/python/django/">django</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      django起步
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="起步"><a href="#起步" class="headerlink" title="起步"></a>起步</h2><ul>
<li>django项目目录</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysite/</span><br><span class="line">    manage.py <span class="comment">#管理django项目的命令行工具</span></span><br><span class="line">    mysite/	<span class="comment">#python包，名字就是当引用它内部任何东西时需要用到的python包名</span></span><br><span class="line">        __init__.py	<span class="comment">#告诉python这个目录应该被认为是一个python包</span></span><br><span class="line">        settings.py	<span class="comment">#项目的配置文件</span></span><br><span class="line">        urls.py <span class="comment">#url声明</span></span><br><span class="line">        asgi.py <span class="comment">#运行在asgi兼容的web服务器上的入口</span></span><br><span class="line">        wsgi.py <span class="comment">#运行在wsgi兼容的web服务器上的入口</span></span><br></pre></td></tr></table></figure>

<ul>
<li>运行项目的命令<code>python manage.py runserver</code></li>
<li>创建一个应用<code>python manage.py startapp polls</code></li>
<li>应用urls.py中使用到的函数path()有四个参数，两个必须参数route和view，两个可选参数kwargs和name<ul>
<li>route是一个匹配URL的准则，当响应一个请求时，他会从urlpatterns的第一项开始，按顺序依次匹配列表中的项。这些准则不会匹配get和post参数或域名</li>
<li>view：当找到了一个匹配的准则，就会调用这个特定的视图函数，并传入一个HttpRequest对象作为第一个参数，被捕获的参数以关键字参数的形式传入。</li>
<li>kwages：任意个关键字参数可作为一个字典传递给目标视图函数。</li>
<li>name：为url取名</li>
</ul>
</li>
<li>函数include()允许引用其他URLconfs</li>
</ul>
<h2 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h2><h3 id="设置mysite-sittings-py"><a href="#设置mysite-sittings-py" class="headerlink" title="设置mysite/sittings.py"></a>设置mysite/sittings.py</h3><ul>
<li>设置时区<code>TIME_ZONE = &#39;Asia/Shanghai&#39; USE_TZ = True</code><ul>
<li>当启用了时区支持（即<code>USE_TZ = True</code>），Django将在数据库中以UTC存储日期信息，而在模板和表单中转化为最终用户的时区</li>
</ul>
</li>
<li>设置数据库</li>
<li><code>INSTALLED_APPS</code>是在项目中启用的Django应用，这里面的某些应用需要数据表，可以用<code>python manage.py migrate</code>生成</li>
</ul>
<h3 id="创建模型"><a href="#创建模型" class="headerlink" title="创建模型"></a>创建模型</h3><ul>
<li>模型设真实数据的描述，它包含了存储的数据所必要的字段和行为。</li>
<li>Django的迁移代码是从模型文件中自动生成的</li>
<li>每个模型都是<code>django.db.models.Model</code>类的子类，每个模型有许多的类变量，他们都表示一个数据库的字段，每个字段都是Field类的实例，每个Field类实例变量的名字也是数据库的列名。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#polls/models.py</span></span><br><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Choice</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    question = models.ForeignKey(Question, on_delete=models.CASCADE)</span><br><span class="line">    choice_text = models.CharField(max_length=<span class="number">200</span>)</span><br><span class="line">    votes = models.IntegerField(default=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<h3 id="激活和修改模型"><a href="#激活和修改模型" class="headerlink" title="激活和修改模型"></a>激活和修改模型</h3><ul>
<li>首先把应用安装到项目中，在<code>INSTALLED_APPS</code>中添加<code>polls.apps.PollsConfig</code></li>
<li>执行<code>python manage.py makemigrations polls</code></li>
<li>迁移数据存放在应用的<code>migrations/0001_initial.py</code>中，可以通过<code>python manage.py sqlmigrate polls 0001</code>来查看对应的sql</li>
<li>运行<code>python manage.py migtate</code>来应用数据库迁移</li>
<li>通过<code>python manage.py shell</code>可进入当前项目对应的命令行</li>
<li>给模型增加<code>__str__</code>方法能带来一些方便</li>
</ul>
<h2 id="Django管理页面"><a href="#Django管理页面" class="headerlink" title="Django管理页面"></a>Django管理页面</h2><ul>
<li>首先创建一个能登陆管理界面的用户<code>python manage.py createsuperuser</code></li>
<li>将创建的models注册，以便后台可以管理</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#polls/admin.py</span></span><br><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Question</span><br><span class="line"></span><br><span class="line">admin.site.register(Question)</span><br></pre></td></tr></table></figure>

<ul>
<li>运行项目<code>python manage.py runserver</code></li>
</ul>
<h2 id="视图view"><a href="#视图view" class="headerlink" title="视图view"></a>视图view</h2><ul>
<li>向应用的views.py中添加视图函数，这些函数的第一个参数是request，也以有第二、第三个参数。每个视图必须做的只有返回一个包含请求页面内容的HttpResponse对象或者抛出一个异常</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">detail</span>(<span class="params">request, question_id</span>):</span></span><br><span class="line">    context = &#123;</span><br><span class="line">        <span class="string">&#x27;question_id&#x27;</span>: question_id,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">#template = loader.get_template(&#x27;xxx/xxxx.html&#x27;)</span></span><br><span class="line">    <span class="comment">#return HttpResponse(template.render(context, request))</span></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;xxx/xxxx.html&#x27;</span>, context)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>当使用模型的get函数获取对象，如果不存在，可以抛出Http404错误，Django提供了一个快捷函数<code>get_object_or_404</code>，</p>
</li>
<li><p>将这些视图添加加到应用的urls.py中</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#为url名称添加命名空间</span></span><br><span class="line">app_name = <span class="string">&#x27;polls&#x27;</span></span><br><span class="line">urlpatterns = [</span><br><span class="line">    <span class="comment">#...</span></span><br><span class="line">    <span class="comment">#int:是一个转换器，决定了应该以什么变量类型匹配这部分url路径</span></span><br><span class="line">    path(<span class="string">&#x27;&lt;int:question_id&gt;/detail/&#x27;</span>, views.detail, name=<span class="string">&#x27;detail&#x27;</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<ul>
<li>当其他人访问网站的某个页面时，比如’polls/34/detail’，django将会载入项目的urls.py模块，因为这在<strong>ROOT_URLCONF</strong>中配置了，然后django寻找名为urlpatterns变量并按顺序匹配正则表达式，在找到匹配项’polls/‘，它切掉了匹配的文本’polls/‘，将剩余文本’34/detail’发送至’polls.urls’中做进一步处理</li>
</ul>
<h3 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h3><ul>
<li>在应用路径下创建templates目录，项目的<strong>TEMPLATES</strong>配置项描述了django如何载入和渲染模板，默认将<strong>APP_DIRS</strong>设置为True，这一选项让DjangoTemplates能在每个INSTALLED_APPS文件夹中寻找templates子目录。</li>
<li>由于django能直接访问到templates文件夹，为了放置出现模板文件名冲突，最好的方法就是将它们放到一个与自身应用重名的子文件夹里</li>
<li>指向具有命名空间的视图</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% url &#x27;polls:detail&#x27; question.id %&#125;&quot;</span>&gt;</span>&#123;&#123; context.question_id &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>无论何时，当需要创建一个改变服务器端数据的表单时，请使用post。</li>
<li>django自带了一个非常有用的防御系统，所有针对内部url的post表单都应该使用<code>&#123;% csrf_token %&#125;</code>模板标签。</li>
<li>request.POST是一个字典类型对象，可以通过关键字来获取提交的数据，获取的值永远是字符串。如果key提供错误，将会抛出一个KeyError。</li>
<li>函数reverse()能避免在视图函数中硬编码url，他需要我们给出想要跳转的视图的名字和该视图所对应的url模式中需要给该视图提供的参数。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/03/17/clickhouse%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          clickhouse集群配置
        
      </div>
    </a>
  
  
    <a href="/2021/03/15/python%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">python正则表达式</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java%E5%B9%B6%E5%8F%91/">java并发</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/jvm/">jvm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/web/">web</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/python/django/">django</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/http/">http</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/zookeeper/">zookeeper</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%B6%E4%BB%96/">其他</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/clickhouse/">clickhouse</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/">mysql</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%8E%92%E5%BA%8F/">排序</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/04/02/mybatis%E5%85%A5%E9%97%A8/">mybatis入门</a>
          </li>
        
          <li>
            <a href="/2021/03/27/zookeeper%E8%B5%B7%E6%AD%A5/">zookeeper起步</a>
          </li>
        
          <li>
            <a href="/2021/03/25/clickhouse%E7%B1%BB%E5%9E%8B%E5%8F%8A%E5%87%BD%E6%95%B0/">clickhouse类型及函数</a>
          </li>
        
          <li>
            <a href="/2021/03/24/cors/">cors</a>
          </li>
        
          <li>
            <a href="/2021/03/22/android/">android</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 小象<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="/js/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>